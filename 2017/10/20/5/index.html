<!DOCTYPE html>
<html lang="z">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>组件内this指向问题 | Ronaldo</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="如无意外，组件内的 this 指向的是组件本身
今天在开发过程中遇到个问题，纠结了很长时间，其实源代码从别人的 demo 复制过来的，但是到我这里就不行了，主要就是做了个全屏功能，发现不考虑 esc 点击 进入/退出 全屏是可行的，但是试了 esc 就有问题了。贴代码：12345678910111213141516171819202122232425262728293031323334353637">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="组件内this指向问题 | Ronaldo">
    <meta name="twitter:description" content="如无意外，组件内的 this 指向的是组件本身
今天在开发过程中遇到个问题，纠结了很长时间，其实源代码从别人的 demo 复制过来的，但是到我这里就不行了，主要就是做了个全屏功能，发现不考虑 esc 点击 进入/退出 全屏是可行的，但是试了 esc 就有问题了。贴代码：12345678910111213141516171819202122232425262728293031323334353637">

    <meta property="og:type" content="article">
    <meta property="og:title" content="组件内this指向问题 | Ronaldo">
    <meta property="og:description" content="如无意外，组件内的 this 指向的是组件本身
今天在开发过程中遇到个问题，纠结了很长时间，其实源代码从别人的 demo 复制过来的，但是到我这里就不行了，主要就是做了个全屏功能，发现不考虑 esc 点击 进入/退出 全屏是可行的，但是试了 esc 就有问题了。贴代码：12345678910111213141516171819202122232425262728293031323334353637">

    
    <meta name="author" content="lizhongzhen">
    
    <link rel="stylesheet" href="/css/vno.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    
    <link rel="icon" href="/images/logo.jpg">
    

    <meta name="generator" content="hexo"/>
    
    <link rel="alternate" type="application/rss+xml" title="Ronaldo" href="/atom.xml">
    

    <link rel="canonical" href="http://yoursite.com/2017/10/20/5/"/>

                 
</head>

<body class="home-template no-js">
    <script src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>

    
<header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/Daniel.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/" title="前往 Ronaldo 的主页"><img src="/images/logo.jpg" width="80" alt="Ronaldo logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage for Ronaldo">Ronaldo</a></h1>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description"></p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />

        <div class="navigation-wrapper">
          <div>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="Visit the blog" class="blog-button">Blog</a></li>
            
              <li class="navigation__item"><a href="https://github.com/lizhongzhen11/lizhongzhen11.github.io">目录</a></li>
            
            </ul>
          </nav>
          </div>
          <div>
          <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  
  <li class="navigation__item">
    <a href="http://weibo.com/3298783260/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo" title="Weibo" target="_blank">
      <i class='social fa fa-weibo'></i>
      <span class="label">Weibo</span>
    </a>
  </li> 


  <!-- Github -->
  
  <li class="navigation__item">
    <a href="https://github.com/lizhongzhen11" title="GitHub" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>


<!-- Stack Overflow -->
        

  <!-- Google Plus -->
  

<!-- Facebook -->

  
<!-- Twitter -->

  

  <li class="navigation__item">
    <a href="/atom.xml" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>



  </ul>
</nav>

          </div>
        </div>

      </div>

    </div>

    <div class="panel-cover--overlay cover-purple"></div>
  </div> 
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2017-10-20T09:52:25.677Z" class="post-list__meta--date date">2017-10-20</time> &#8226; <span class="post-meta__tags tags">于  </span>
      <span class="page-pv">
       Read <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>
      </span> 
   
    </div>
    <h1 class="post-title">组件内this指向问题</h1>
  </header>

  <section class="post">
    <h3 id="如无意外，组件内的-this-指向的是组件本身"><a href="#如无意外，组件内的-this-指向的是组件本身" class="headerlink" title="如无意外，组件内的 this 指向的是组件本身"></a>如无意外，组件内的 this 指向的是组件本身</h3><blockquote>
<p>今天在开发过程中遇到个问题，纠结了很长时间，其实源代码从别人的 demo 复制过来的，但是到我这里就不行了，主要就是做了个全屏功能，发现不考虑 esc 点击 进入/退出 全屏是可行的，但是试了 esc 就有问题了。贴代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line">var ScreenFull = Vue.extend(&#123;</div><div class="line">    template: &apos;&lt;svg @click=&quot;screenFull&quot; class=&quot;icon screenfull&quot; &apos; +</div><div class="line">                &apos;xmlns=&quot;http://www.w3.org/2000/svg&quot; &apos; +</div><div class="line">                &apos;xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; &apos; +</div><div class="line">                &apos;t=&quot;1497503607356&quot; viewBox=&quot;0 0 1024 1024&quot; version=&quot;1.1&quot; p-id=&quot;4109&quot; &apos; +</div><div class="line">                &apos;:fill=&quot;fill&quot; &apos; +</div><div class="line">                &apos;:width=&quot;width&quot; &apos; +</div><div class="line">                &apos;:height=&quot;height&quot;&gt; &apos; +</div><div class="line">                &apos;&lt;path d=&quot;M604.157933 512l204.484208 204.484208 82.942037-82.942037c10.364045-10.952446 &apos; +</div><div class="line">                &apos;26.498514-13.83817 40.309054-8.067746 13.249769 5.742794 22.465664 18.99154 22.465664 &apos; +</div><div class="line">                &apos;33.977859l0 258.042008c0 20.168342-16.695241 36.863582-36.863582 36.863582L659.452283 &apos; +</div><div class="line">                &apos;954.357873c-14.986319 0-28.236088-9.215896-33.977859-23.025413-5.770424-13.249769-2.885723-29.384237 &apos; +</div><div class="line">                &apos;8.067746-39.748283l82.942037-82.942037L512 604.157933 307.515792 808.642141l82.942037 &apos; +</div><div class="line">                &apos;82.942037c10.952446 10.364045 13.83817 26.498514 8.067746 39.748283-5.742794 13.809517-18.99154 &apos; +</div><div class="line">                &apos;23.025413-33.977859 23.025413L106.504686 954.357873c-20.168342 0-36.863582-16.695241-36.863582-36.863582L69.641103 &apos; +</div><div class="line">                &apos;659.452283c0-14.986319 9.215896-28.236088 23.025413-33.977859 13.249769-5.770424 29.384237-2.8847 39.748283 &apos; +</div><div class="line">                &apos;8.067746l82.942037 82.942037 204.484208-204.484208L215.357859 307.515792l-82.942037 82.942037c-6.890944 &apos; +</div><div class="line">                &apos;6.918573-16.10684 10.952446-25.911136 10.952446-4.593622 &apos; +</div><div class="line">                &apos;0-9.804297-1.14815-13.83817-2.8847-13.809517-5.742794-23.025413-18.99154-23.025413-33.977859L69.641103 &apos; +</div><div class="line">                &apos;106.504686c0-20.168342 16.695241-36.863582 36.863582-36.863582L364.546693 69.641103c14.986319 0 28.236088 &apos; +</div><div class="line">                &apos;9.215896 33.977859 23.025413 5.770424 13.249769 2.8847 29.384237-8.067746 39.748283l-82.942037 &apos; +</div><div class="line">                &apos;82.942037 204.484208 204.484208L716.484208 215.357859l-82.942037-82.942037c-10.952446-10.364045-13.83817-26.498514-8.067746-39.748283 &apos; +</div><div class="line">                &apos;5.742794-13.809517 18.99154-23.025413 33.977859-23.025413l258.042008 0c20.168342 0 36.863582 16.695241 36.863582 36.863582l0 &apos; +</div><div class="line">                &apos;258.042008c0 14.986319-9.215896 28.236088-22.465664 33.977859-4.593622 1.736551-9.804297 2.8847-14.397918 2.8847-9.804297 &apos; +</div><div class="line">                &apos;0-19.020192-4.033873-25.911136-10.952446l-82.942037-82.942037L604.157933 512z&quot; &apos; +</div><div class="line">                &apos;p-id=&quot;4110&quot; /&gt; &apos; +</div><div class="line">                &apos;&lt;/svg&gt;&apos;,</div><div class="line">    props: &#123;</div><div class="line">        width: &#123;</div><div class="line">            type: Number,</div><div class="line">            default: 22</div><div class="line">        &#125;,</div><div class="line">        height: &#123;</div><div class="line">            type: Number,</div><div class="line">            default: 22</div><div class="line">        &#125;,</div><div class="line">        fill: &#123;</div><div class="line">            type: String,</div><div class="line">            default: &apos;#48576a&apos;</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    data: function () &#123;</div><div class="line">        return &#123;</div><div class="line">            isFullScreen: false</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    created: function () &#123;</div><div class="line">        var self = this;</div><div class="line">        // 全屏相关</div><div class="line">        document.addEventListener(&apos;fullscreenchange&apos;, function () &#123;</div><div class="line">            return self.isFullScreen = !self.isFullScreen;</div><div class="line">        &#125;);</div><div class="line">        document.addEventListener(&apos;mozfullscreenchange&apos;, function () &#123;</div><div class="line">            return self.isFullScreen = !self.isFullScreen;</div><div class="line">        &#125;);</div><div class="line">        document.addEventListener(&apos;webkitfullscreenchange&apos;, function () &#123;</div><div class="line">            return self.isFullScreen = !self.isFullScreen;</div><div class="line">        &#125;);</div><div class="line">        document.addEventListener(&apos;msfullscreenchange&apos;, function () &#123;</div><div class="line">            return self.isFullScreen = !self.isFullScreen;</div><div class="line">        &#125;);</div><div class="line">    &#125;,</div><div class="line">    methods: &#123;</div><div class="line">        screenFull: function () &#123;</div><div class="line">            console.log(&apos;方法=======&apos;+this.isFullScreen);</div><div class="line">            var main = document.getElementById(&quot;app&quot;);</div><div class="line">            if (this.isFullScreen) &#123;</div><div class="line">                if (document.exitFullscreen) &#123;</div><div class="line">                    document.exitFullscreen();</div><div class="line">                &#125; else if (document.mozCancelFullScreen) &#123;</div><div class="line">                    document.mozCancelFullScreen();</div><div class="line">                &#125; else if (document.webkitCancelFullScreen) &#123;</div><div class="line">                    document.webkitCancelFullScreen();</div><div class="line">                &#125; else if (document.msExitFullscreen) &#123;</div><div class="line">                    document.msExitFullscreen();</div><div class="line">                &#125;</div><div class="line">            &#125; else &#123;</div><div class="line">                if (main.requestFullscreen) &#123;</div><div class="line">                    main.requestFullscreen();</div><div class="line">                &#125; else if (main.mozRequestFullScreen) &#123;</div><div class="line">                    main.mozRequestFullScreen();</div><div class="line">                &#125; else if (main.webkitRequestFullScreen) &#123;</div><div class="line">                    main.webkitRequestFullScreen();</div><div class="line">                &#125; else if (main.msRequestFullscreen) &#123;</div><div class="line">                    main.msRequestFullscreen();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    watch: &#123;</div><div class="line">        isFullScreen: function (newValue, oldValue) &#123;</div><div class="line">            console.log(&apos;newValue: &apos; + newValue, &apos;oldValue: &apos; + oldValue);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>注意仔细看代码，这段代码是一个叫 ScreenFull 的组件，screenFull 方法里面通过 this.isFullScreen 的确可以得到目前 isFullScreen 的值，因为这里的 this 指向的是 ScreenFull 组件本身。但是，在 created 钩子函数里，如果直接在 document 的监听函数里打印 this.isFullScreen 结果却是 undefined，这是因为 document 监听函数里面的 this 其实指向的是 document，也就是最外面的那个 div(有的话)，所以在这里用 this.isFullScreen 是怎么也得不到值得，所以 watch 的监听也没有任何反应。但是在 created 钩子函数一开始就把 this 赋值给一个变量，这里是 self，下面通过 self.isFullScreen 就可以改变 isFullScreen 的值了。</p>
<p>还有，MMP，最近打代码老是打错名字，大大降低效率，徒增烦恼。要避免！</p>
</blockquote>

  </section>

</article>

<section class="read-more">
           
    
               
            <div class="read-more-item">
                <span class="read-more-item-dim">Newer Post</span>
                <h2 class="post-list__post-title post-title"><a href="/2017/10/23/js_return/" title="js return">js return</a></h2>
                <p class="excerpt">
                
                今天看囧克斯关于 vue 源码解读发现一段代码通过 return 巧妙地避免了不必要的深度遍历(在有广播事件到来时，如果当前 vm 的 _eventsCount 为 0，则不必向其子 vm 继续传播该事件)，当时看到return都有点忘了，基础不牢固

源码123456789101112export
                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2017-10-23T02:29:19.325Z" class="post-list__meta--date date">2017-10-23</time> &#8226; <span class="post-list__meta--tags tags">于 </span><a class="btn-border-small" href="/2017/10/23/js_return/">继续阅读</a></div>
                           
            </div>
        
        
               
            <div class="read-more-item">
                <span class="read-more-item-dim">Older Post</span>
                <h2 class="post-list__post-title post-title"><a href="/2017/10/19/Js_If/" title="js if条件判断问题">js if条件判断问题</a></h2>
                <p class="excerpt">
                
                今天改bug时遇到个 if 判断问题，记录下1234var a = 1;if (a == 2 || 3) &amp;#123;	console.log(a)&amp;#125;

一开始，我以为上面这样写就对了，后来发现并不是。。。特地研究了下，其实这里我犯了个语法错误，js里面并没有这种简略写法，有一种写法是 a
                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2017-10-19T03:14:22.222Z" class="post-list__meta--date date">2017-10-19</time> &#8226; <span class="post-list__meta--tags tags">于 </span><a class="btn-border-small" href="/2017/10/19/Js_If/">继续阅读</a></div>
                       
            </div>
        
     
   
   
  
</section>

  

            <footer class="footer">
    <span class="footer__copyright">
        &copy; 2018 lizhongzhen - 本站点采用 <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>
       
    </span>
    <span class="footer__copyright">
             - 基于 <a href="http://hexo.io">Hexo</a> 搭建，使用 <a href="https://github.com/monniya/hexo-theme-new-vno ">new-vno</a> 主题，由<a href="https://monniya.com ">@Monniya</a> 修改自 <a href="https://github.com/lenbo-ma/hexo-theme-vno" target="_blank">Vno</a>, 原创出自<a href="http://github.com/onevcat/vno" target="_blank">onevcat</a>
         </span>
       
    
    
</footer>


        </div>
    </div>

     
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-78918255-1', 'auto');
	ga('send', 'pageview');
</script>

    
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?9cdad07c755fa23f6aced510c6760e87";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>



    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
</body>
</html>
